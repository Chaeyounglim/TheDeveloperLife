<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"
            integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script>
    <meta charset="UTF-8">
    <title>게시글 상세 페이지</title>

    <style>
        .title {
            text-align: center;
            margin-top: 30px;
            background-color: white;
        }
        .leftBtn {
            margin-left: 20px;
            margin-top: 20px;
            margin-right: 20px;
            text-align: right;
            display: inline-block;
        }
        .rightBtn{
            float: right;
            text-align: right;
            margin-left: 10px;
            margin-top: 20px;
            margin-right: 10px;
        }

        .all-body {
            text-align: center;
        }

        .comment-textarea{
            width: 500px;
            text-align: left;
        }
    </style>

    <script>
        let postId = [[${post.id}]]

        $(document).ready(function () {

        });

        function deleteRequest() {
            console.log(postId)
            $.ajax({
                type:'DELETE',
                url:'/api/post/'+ postId,
                success: function(response) {
                    alert("게시글 삭제 성공");
                    window.location.href = "/";
                }, error: function(req,status,error) {
                    alert("게시글 삭제 실패");
                }
            })
        }

    </script>

</head>
<body>

<div class="leftBtn">
    <input type="button" class="btn btn-dark" value="Back" onClick="location.href='/'"/>
</div>

<div class="rightBtn">
    <span class="welcome-msg" th:text="${user}"></span> 님, 환영합니다.<br/>
    <button onClick="location.href='/api/user/login-page'"  class="btn btn-dark"> Log In </button>
    <button onClick="location.href='/api/user/signup'" class="btn btn-dark"> Sign Up </button>
</div>
<br/><br/>

<div class="title">
    <h1> The Developer Life</h1>
</div>
<br/>

<div class="all-body">


    <div class="post-details">
        <h3 class="post-title" th:text="${post.title}"></h3>
        <br/>
        <hr>
        <div class="post-info">
            <span class="author">작성자</span> : <span th:text="${post.userName}"> </span>
            <span class="date">게시일</span> : <span th:text="${post.createdAt}"> </span>
            <br/>
            <div class="rightBtn">
                <button type="button" class="btn btn-dark" th:onclick="|location.href='@{/api/post/modify(id=${post.id})}'|">수정</button>
                <button type="button" class="btn btn-dark" th:onclick="deleteRequest()">삭제</button>
                <button type="button" class="btn btn-dark" onClick="location.href='/'">목록</button>
                <br/>
            </div>
        </div>
        <br/>
        <div class="content">
            <span class="author">내용 </span> <br/>
            <textarea cols="50" rows="10" th:text="${post.content}"> </textarea>
        </div>

        <hr>
        <div class="comments">
            <h3>댓글</h3>
            <div class="comment-list">
                <!-- 댓글 목록이 여기에 동적으로 추가될 예정 -->
            </div>
            <div class="new-comment">
                <textarea class="comment-textarea" placeholder="댓글을 입력하세요"></textarea>
                <button class="comment-submit-btn">등록</button>
            </div>
        </div>
    </div>
</div>

</body>
</html>